---
interface Props {
  city: string;
  state: string;
  loanType: string;
  loanSlug: string;
  title: string;
  description: string;
  keywords: string;
  heroDescription: string;
  benefits: { title: string; description: string }[];
  faqs: { question: string; answer: string }[];
  cityDescription: string;
}

import BaseLayout from '@/layouts/BaseLayout.astro';
import SEOHead from '@/components/SEOHead.astro';
import BreadcrumbSchema from '@/components/schemas/BreadcrumbSchema.astro';
import ServiceSchema from '@/components/schemas/ServiceSchema.astro';
import LocalBusinessSchema from '@/components/schemas/LocalBusinessSchema.astro';
import FAQSchema from '@/components/schemas/FAQSchema.astro';

const { city, state, loanType, loanSlug, title, description, keywords, heroDescription, benefits, faqs, cityDescription } = Astro.props;

const citySlug = city.toLowerCase().replace(/\s+/g, '-');
const pageUrl = `https://www.nik.finance/${loanSlug}-${citySlug}`;
const ctaUrl = 'https://app.middle.finance/ref/7d27aec6-deb1-4e44-8bd8-85f8f8aecff3';

const breadcrumbs = [
  { name: 'Home', url: 'https://www.nik.finance/' },
  { name: loanType, url: `https://www.nik.finance/${loanSlug}` },
  { name: `${loanType} ${city}`, url: pageUrl },
];

const allCities = [
  { name: 'Sydney', state: 'NSW' },
  { name: 'Melbourne', state: 'VIC' },
  { name: 'Brisbane', state: 'QLD' },
  { name: 'Perth', state: 'WA' },
  { name: 'Adelaide', state: 'SA' },
  { name: 'Canberra', state: 'ACT' },
  { name: 'Gold Coast', state: 'QLD' },
];

const allLoanTypes = [
  { name: 'Home Loans', slug: 'home-loans' },
  { name: 'Car Loans', slug: 'car-loans' },
  { name: 'Personal Loans', slug: 'personal-loans' },
  { name: 'Business Loans', slug: 'business-loans' },
];

const otherCities = allCities.filter(c => c.name !== city);
const otherLoanTypes = allLoanTypes.filter(l => l.slug !== loanSlug);
---

<BaseLayout>
  <Fragment slot="seo">
    <SEOHead
      title={title}
      description={description}
      keywords={keywords}
      canonical={pageUrl}
    />
  </Fragment>
  <Fragment slot="schema">
    <BreadcrumbSchema items={breadcrumbs} />
    <ServiceSchema
      serviceName={`${loanType} ${city}`}
      serviceDescription={`${loanType} in ${city}, ${state}. Compare rates from 130+ lenders with NIK Finance's free AI-powered broking service.`}
      serviceUrl={pageUrl}
      areaServed={city}
    />
    <LocalBusinessSchema city={city} state={state} />
    <FAQSchema faqs={faqs} />
  </Fragment>

  <!-- Hero Section -->
  <section class="relative bg-gradient-to-br from-secondary via-primary to-primary py-20 md:py-28 overflow-hidden">
    <div class="absolute inset-0 opacity-10">
      <div class="absolute top-0 left-1/2 w-96 h-96 bg-accent rounded-full blur-3xl -translate-x-1/2 -translate-y-1/3"></div>
      <div class="absolute bottom-0 right-0 w-80 h-80 bg-accent rounded-full blur-3xl translate-x-1/3 translate-y-1/3"></div>
    </div>
    <div class="relative max-w-6xl mx-auto px-4 sm:px-6 text-center">
      <nav aria-label="Breadcrumb" class="mb-6">
        <ol class="flex items-center justify-center gap-2 text-sm text-primary-foreground/70">
          <li><a href="/" class="hover:text-white transition-colors">Home</a></li>
          <li aria-hidden="true">/</li>
          <li><a href={`/${loanSlug}`} class="hover:text-white transition-colors">{loanType}</a></li>
          <li aria-hidden="true">/</li>
          <li class="text-white font-medium">{city}</li>
        </ol>
      </nav>
      <h1 class="font-heading text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-6 leading-tight">
        {loanType} in {city}
      </h1>
      <p class="font-paragraph text-lg md:text-xl text-primary-foreground/90 max-w-3xl mx-auto mb-10 leading-relaxed">
        {heroDescription}
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a
          href={ctaUrl}
          class="inline-flex items-center justify-center px-8 py-4 bg-accent hover:bg-accent/90 text-white font-heading font-bold rounded-lg text-lg transition-all duration-200 shadow-lg hover:shadow-xl hover:-translate-y-0.5"
        >
          Apply Now
        </a>
        <a
          href="/contact"
          class="inline-flex items-center justify-center px-8 py-4 bg-white/10 hover:bg-white/20 text-white font-heading font-semibold rounded-lg text-lg transition-all duration-200 border border-white/30"
        >
          Get Free Assessment
        </a>
      </div>
    </div>
  </section>

  <!-- City-Specific Intro Section -->
  <section class="py-16 md:py-20 bg-white">
    <div class="max-w-4xl mx-auto px-4 sm:px-6">
      <h2 class="font-heading text-3xl md:text-4xl font-bold text-primary mb-6 text-center">
        {loanType} for {city} Residents
      </h2>
      <p class="font-paragraph text-lg text-foreground/70 leading-relaxed">
        {cityDescription}
      </p>
    </div>
  </section>

  <!-- Benefits Grid -->
  <section class="py-16 md:py-24 bg-light-gray">
    <div class="max-w-6xl mx-auto px-4 sm:px-6">
      <div class="text-center mb-14">
        <h2 class="font-heading text-3xl md:text-4xl font-bold text-primary mb-4">
          Why Choose NIK Finance for {loanType} in {city}?
        </h2>
        <p class="font-paragraph text-lg text-foreground/70 max-w-2xl mx-auto">
          We combine local market knowledge with AI-powered lender matching to get you the best deal.
        </p>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {benefits.map((benefit) => (
          <div class="bg-white rounded-xl p-8 hover:shadow-lg transition-shadow duration-300">
            <div class="w-14 h-14 bg-accent/10 rounded-lg flex items-center justify-center mb-5">
              <svg class="w-7 h-7 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
            </div>
            <h3 class="font-heading text-xl font-bold text-primary mb-3">{benefit.title}</h3>
            <p class="font-paragraph text-foreground/70 leading-relaxed">{benefit.description}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- How It Works Section -->
  <section class="py-16 md:py-24 bg-white">
    <div class="max-w-6xl mx-auto px-4 sm:px-6">
      <div class="text-center mb-14">
        <h2 class="font-heading text-3xl md:text-4xl font-bold text-primary mb-4">
          How to Get {loanType} in {city}
        </h2>
        <p class="font-paragraph text-lg text-foreground/70 max-w-2xl mx-auto">
          Our streamlined process makes securing your loan fast and straightforward.
        </p>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
        <div class="text-center">
          <div class="w-16 h-16 bg-secondary rounded-full flex items-center justify-center mx-auto mb-5">
            <span class="text-white font-heading font-bold text-2xl">1</span>
          </div>
          <h3 class="font-heading text-lg font-bold text-primary mb-3">Share Your Goals</h3>
          <p class="font-paragraph text-foreground/70 leading-relaxed">
            Complete a short online assessment or call us. Tell us about your financial situation and what you need.
          </p>
        </div>
        <div class="text-center">
          <div class="w-16 h-16 bg-secondary rounded-full flex items-center justify-center mx-auto mb-5">
            <span class="text-white font-heading font-bold text-2xl">2</span>
          </div>
          <h3 class="font-heading text-lg font-bold text-primary mb-3">AI Matches Lenders</h3>
          <p class="font-paragraph text-foreground/70 leading-relaxed">
            Our AI scans 130+ lenders to find the best rates and products for your profile and {city} requirements.
          </p>
        </div>
        <div class="text-center">
          <div class="w-16 h-16 bg-secondary rounded-full flex items-center justify-center mx-auto mb-5">
            <span class="text-white font-heading font-bold text-2xl">3</span>
          </div>
          <h3 class="font-heading text-lg font-bold text-primary mb-3">Expert Consultation</h3>
          <p class="font-paragraph text-foreground/70 leading-relaxed">
            A dedicated broker reviews the recommendations with you, explains your options, and tailors the structure to your needs.
          </p>
        </div>
        <div class="text-center">
          <div class="w-16 h-16 bg-secondary rounded-full flex items-center justify-center mx-auto mb-5">
            <span class="text-white font-heading font-bold text-2xl">4</span>
          </div>
          <h3 class="font-heading text-lg font-bold text-primary mb-3">Approval & Funding</h3>
          <p class="font-paragraph text-foreground/70 leading-relaxed">
            We handle the full application, liaise with the lender, and guide you through to approval and settlement.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ Section -->
  <section class="py-16 md:py-24 bg-light-gray">
    <div class="max-w-4xl mx-auto px-4 sm:px-6">
      <div class="text-center mb-14">
        <h2 class="font-heading text-3xl md:text-4xl font-bold text-primary mb-4">
          {loanType} in {city} - Frequently Asked Questions
        </h2>
        <p class="font-paragraph text-lg text-foreground/70 max-w-2xl mx-auto">
          Common questions about {loanType.toLowerCase()} for {city} residents.
        </p>
      </div>
      <div class="space-y-4">
        {faqs.map((faq) => (
          <details class="bg-white rounded-xl p-6 group cursor-pointer">
            <summary class="font-heading font-bold text-lg text-primary flex items-center justify-between list-none">
              {faq.question}
              <svg class="w-5 h-5 text-accent flex-shrink-0 ml-4 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </summary>
            <p class="font-paragraph text-foreground/70 mt-4 leading-relaxed">{faq.answer}</p>
          </details>
        ))}
      </div>
    </div>
  </section>

  <!-- Related Services Section -->
  <section class="py-16 md:py-20 bg-white">
    <div class="max-w-6xl mx-auto px-4 sm:px-6">
      <h2 class="font-heading text-2xl md:text-3xl font-bold text-primary mb-8 text-center">
        Other Finance Solutions in {city}
      </h2>
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
        {otherLoanTypes.map((loan) => (
          <a href={`/${loan.slug}-${citySlug}`} class="block border border-gray-200 rounded-xl p-6 hover:border-accent hover:shadow-md transition-all duration-200 group">
            <h3 class="font-heading font-bold text-primary group-hover:text-accent transition-colors">{loan.name} {city}</h3>
            <p class="font-paragraph text-sm text-foreground/60 mt-2">Compare {loan.name.toLowerCase()} from 130+ lenders in {city}.</p>
          </a>
        ))}
      </div>
    </div>
  </section>

  <!-- Service Areas Section -->
  <section class="py-16 md:py-20 bg-light-gray">
    <div class="max-w-6xl mx-auto px-4 sm:px-6">
      <h2 class="font-heading text-2xl md:text-3xl font-bold text-primary mb-8 text-center">
        {loanType} in Other Cities
      </h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        {otherCities.map((c) => (
          <a href={`/${loanSlug}-${c.name.toLowerCase().replace(/\s+/g, '-')}`} class="block border border-gray-200 bg-white rounded-xl p-6 hover:border-accent hover:shadow-md transition-all duration-200 group">
            <h3 class="font-heading font-bold text-primary group-hover:text-accent transition-colors">{loanType} {c.name}</h3>
            <p class="font-paragraph text-sm text-foreground/60 mt-2">{loanType} solutions for {c.name}, {c.state} residents.</p>
          </a>
        ))}
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-16 md:py-24 bg-gradient-to-br from-secondary to-primary">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 text-center">
      <h2 class="font-heading text-3xl md:text-4xl font-bold text-white mb-6">
        Ready for {loanType} in {city}?
      </h2>
      <p class="font-paragraph text-lg text-primary-foreground/90 mb-10 max-w-2xl mx-auto leading-relaxed">
        Let our AI-powered platform and expert brokers find the best {loanType.toLowerCase()} for your {city} needs. Our service is completely free for borrowers -- lenders pay us, not you.
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a
          href={ctaUrl}
          class="inline-flex items-center justify-center px-8 py-4 bg-accent hover:bg-accent/90 text-white font-heading font-bold rounded-lg text-lg transition-all duration-200 shadow-lg hover:shadow-xl hover:-translate-y-0.5"
        >
          Apply Now
        </a>
        <a
          href="/contact"
          class="inline-flex items-center justify-center px-8 py-4 bg-white/10 hover:bg-white/20 text-white font-heading font-semibold rounded-lg text-lg transition-all duration-200 border border-white/30"
        >
          Talk to a Broker
        </a>
      </div>
      <p class="font-paragraph text-sm text-primary-foreground/60 mt-8">
        NIK Finance Pty Ltd | ACN 685 393 917 | Credit Representative No. 567387 of Finsure Finance and Insurance Pty Ltd (Australian Credit Licence 384704)
      </p>
    </div>
  </section>
</BaseLayout>
